<odoo>
    <record id="stock_inventory_pdf_report_report" model="ir.actions.report">
        <field name="name">Inventory Valuation Report</field>
        <field name="model">inventory.valuation.report</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">eg_inventory_valuation_report.stock_inventory_pdf_report</field>
        <field name="report_file">eg_inventory_valuation_report.stock_inventory_pdf_report</field>
        <field name="attachment">False</field>
    </record>

    <template id="stock_inventory_pdf_report">
        <t t-call="web.html_container">
            <t t-set="doc_ids" t-value="[o.id for o in docs]"/>
            <t t-set="doc_model" t-value="'inventory.valuation.report'"/>
            
            <div class="page">
                <div style="position: absolute; left: 20px; top: -10px; text-align: left;">
                    <p>
                        <t t-esc="company_name"/>
                        <br/>
                        <t t-esc="company_street"/>
                        <br/>
                        <t t-esc="company_city"/>
                        <br/>
                        <t t-esc="company_zip"/>
                        <br/>
                        <t t-esc="company_country"/>
                    </p>
                </div>

                <div style="text-align: center; margin-bottom: 40px;">
                    <h2>Inventory Valuation Report</h2>
                    <p>
                        <strong>Report Duration:</strong>
                        From
                        <t t-esc="start_date"/>
                        to
                        <t t-esc="end_date"/>
                    </p>
                    <p>
                        <strong>Filter Type:</strong>
                        <t t-esc="filter_type.title()"/>
                    </p>
                </div>

                <t t-foreach="targets" t-as="target">
                    <div class="page">
                        <div style="text-align: center; margin-bottom: 40px;">
                            <h3>
                                <t t-if="target['type'] == 'warehouse'">Warehouse:</t>
                                <t t-elif="target['type'] == 'location'">Location:</t>
                                <t t-esc="target['name']"/>
                            </h3>
                        </div>

                        <table class="table table-bordered"
                               style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                            <thead>
                                <tr style="background-color: #f2f2f2;">
                                    <th style="border: 1px solid #000; padding: 8px;">Product Name</th>
                                    <th style="border: 1px solid #000; padding: 8px;">Cost Method</th>
                                    <th style="border: 1px solid #000; padding: 8px;">Beginning Qty</th>
                                    <th style="border: 1px solid #000; padding: 8px;">Beginning Value</th>
                                    <th style="border: 1px solid #000; padding: 8px;">Received Qty</th>
                                    <th style="border: 1px solid #000; padding: 8px;">Received Value</th>
                                    <th style="border: 1px solid #000; padding: 8px;">Sale Qty</th>
                                    <th style="border: 1px solid #000; padding: 8px;">Sale Value</th>
                                    <th style="border: 1px solid #000; padding: 8px;">Internal Qty</th>
                                    <th style="border: 1px solid #000; padding: 8px;">Internal Value</th>
                                    <th style="border: 1px solid #000; padding: 8px;">Adjustment Qty</th>
                                    <th style="border: 1px solid #000; padding: 8px;">Adjustment Value</th>
                                    <th style="border: 1px solid #000; padding: 8px;">Ending Qty</th>
                                    <th style="border: 1px solid #000; padding: 8px;">Ending Value</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-if="filter_by == 'product'">
                                    <t t-foreach="target['products']" t-as="line">
                                        <tr>
                                            <td style="border: 1px solid #000; padding: 8px;">
                                                <t t-esc="line['name']"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px;">
                                               <t t-esc="line.get('costing_method', '')"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:.2f}'.format(line.get('beginning_qty', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:,.2f}'.format(line.get('beginning_value', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:.2f}'.format(line.get('received_qty', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:,.2f}'.format(line.get('received_value', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:.2f}'.format(line.get('sales_qty', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:,.2f}'.format(line.get('sales_value', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:.2f}'.format(line.get('internal_qty', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:,.2f}'.format(line.get('internal_value', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:.2f}'.format(line.get('adjustment_qty', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:,.2f}'.format(line.get('adjustment_value', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:.2f}'.format(line.get('ending_qty', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:,.2f}'.format(line.get('ending_value', 0))"/>
                                            </td>
                                        </tr>
                                    </t>
                                    <tr style="background-color: #f2f2f2;">
                                        <td style="border: 1px solid #000; padding: 8px; text-align: center;"
                                            colspan="1">
                                            <strong>Total</strong>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px;">

                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:.2f}'.format(target['totals'].get('beginning_qty', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:,.2f}'.format(target['totals'].get('beginning_value', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:.2f}'.format(target['totals'].get('received_qty', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:,.2f}'.format(target['totals'].get('received_value', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:.2f}'.format(target['totals'].get('sales_qty', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:,.2f}'.format(target['totals'].get('sales_value', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:.2f}'.format(target['totals'].get('internal_qty', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:,.2f}'.format(target['totals'].get('internal_value', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:.2f}'.format(target['totals'].get('adjustment_qty', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:,.2f}'.format(target['totals'].get('adjustment_value', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:.2f}'.format(target['totals'].get('ending_qty', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:,.2f}'.format(target['totals'].get('ending_value', 0))"/>
                                        </td>
                                    </tr>
                                </t>
                                <t t-elif="filter_by == 'category'">
                                    <t t-foreach="target['products']" t-as="category">
                                        <tr>
                                            <td colspan="14"
                                                style="background-color: #f2f2f2; font-weight: bold; text-align: center;">
                                                <t t-esc="category['category_name']"/>
                                            </td>
                                        </tr>
                                        <t t-foreach="category['products']" t-as="line">
                                            <tr>
                                                <td style="border: 1px solid #000; padding: 8px;">
                                                    <t t-esc="line['name']"/>
                                                </td>
                                                <td style="border: 1px solid #000; padding: 8px;">
                                                    <t t-esc="line.get('costing_method', '')"/>
                                                </td>
                                                <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                    <t t-esc="'{:.2f}'.format(line.get('beginning_qty', 0))"/>
                                                </td>
                                                <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                    <t t-esc="'{:,.2f}'.format(line.get('beginning_value', 0))"/>
                                                </td>
                                                <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                    <t t-esc="'{:.2f}'.format(line.get('received_qty', 0))"/>
                                                </td>
                                                <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                    <t t-esc="'{:,.2f}'.format(line.get('received_value', 0))"/>
                                                </td>
                                                <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                    <t t-esc="'{:.2f}'.format(line.get('sales_qty', 0))"/>
                                                </td>
                                                <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                    <t t-esc="'{:,.2f}'.format(line.get('sales_value', 0))"/>
                                                </td>
                                                <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                    <t t-esc="'{:.2f}'.format(line.get('internal_qty', 0))"/>
                                                </td>
                                                <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                    <t t-esc="'{:,.2f}'.format(line.get('internal_value', 0))"/>
                                                </td>
                                                <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                    <t t-esc="'{:.2f}'.format(line.get('adjustment_qty', 0))"/>
                                                </td>
                                                <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                    <t t-esc="'{:,.2f}'.format(line.get('adjustment_value', 0))"/>
                                                </td>
                                                <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                    <t t-esc="'{:.2f}'.format(line.get('ending_qty', 0))"/>
                                                </td>
                                                <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                    <t t-esc="'{:,.2f}'.format(line.get('ending_value', 0))"/>
                                                </td>
                                            </tr>
                                        </t>
                                        <tr style="background-color: #f2f2f2;">
                                            <td style="border: 1px solid #000; padding: 8px; text-align: center;"
                                                colspan="1">
                                                <strong>Category Total</strong>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px;">

                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:.2f}'.format(category['category_totals'].get('beginning_qty', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:,.2f}'.format(category['category_totals'].get('beginning_value', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:.2f}'.format(category['category_totals'].get('received_qty', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:,.2f}'.format(category['category_totals'].get('received_value', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:.2f}'.format(category['category_totals'].get('sales_qty', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:,.2f}'.format(category['category_totals'].get('sales_value', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:.2f}'.format(category['category_totals'].get('internal_qty', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:,.2f}'.format(category['category_totals'].get('internal_value', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:.2f}'.format(category['category_totals'].get('adjustment_qty', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:,.2f}'.format(category['category_totals'].get('adjustment_value', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:.2f}'.format(category['category_totals'].get('ending_qty', 0))"/>
                                            </td>
                                            <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                                <t t-esc="'{:,.2f}'.format(category['category_totals'].get('ending_value', 0))"/>
                                            </td>
                                        </tr>
                                    </t>
                                    <tr style="background-color: #f2f2f2;">
                                        <td style="border: 1px solid #000; padding: 8px; text-align: center;"
                                            colspan="1">
                                            <strong>Total</strong>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px;">

                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:.2f}'.format(target['totals'].get('beginning_qty', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:,.2f}'.format(target['totals'].get('beginning_value', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:.2f}'.format(target['totals'].get('received_qty', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:,.2f}'.format(target['totals'].get('received_value', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:.2f}'.format(target['totals'].get('sales_qty', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:,.2f}'.format(target['totals'].get('sales_value', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:.2f}'.format(target['totals'].get('internal_qty', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:,.2f}'.format(target['totals'].get('internal_value', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:.2f}'.format(target['totals'].get('adjustment_qty', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:,.2f}'.format(target['totals'].get('adjustment_value', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:.2f}'.format(target['totals'].get('ending_qty', 0))"/>
                                        </td>
                                        <td style="border: 1px solid #000; padding: 8px; text-align: right;">
                                            <t t-esc="'{:,.2f}'.format(target['totals'].get('ending_value', 0))"/>
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>
                    <t t-if="not target_last">
                        <div style="page-break-before: always;"></div>
                    </t>
                </t>
            </div>
        </t>
    </template>
</odoo>